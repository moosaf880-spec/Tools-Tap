<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Document Converter â€” Bright Blue</title>
<style>
:root{--blue:#1677ff;--bg:#ffffff;--muted:#5b6b8a}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#f6f9ff,#fff);padding:16px;display:flex;justify-content:center}
.app{width:100%;max-width:700px;background:var(--bg);border-radius:12px;padding:18px;box-shadow:0 12px 40px rgba(22,119,255,.06);border:1px solid #e7f3ff}
.title{background:linear-gradient(90deg,var(--blue),#51a4ff);color:#fff;padding:10px 14px;border-radius:8px;font-weight:700;margin-bottom:16px;text-align:center}
.panel{background:#fff;border-radius:10px;padding:14px;border:1px solid #eef6ff}
.h{margin:0 0 8px 0;color:var(--muted);font-weight:700;text-align:center}
.input-file{border:2px dashed #cfe1ff;padding:20px;border-radius:10px;text-align:center;cursor:pointer;color:var(--muted);display:block;margin-bottom:12px}
select,input[type=text]{padding:8px;border:1px solid #dbeeff;border-radius:8px;width:100%;margin-top:8px}
button{background:var(--blue);color:#fff;border:none;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:700;margin-top:12px;width:100%}
.progress{height:10px;background:#eef7ff;border-radius:8px;overflow:hidden;border:1px solid #e6f0ff;margin-top:12px;display:none}
.progress > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--blue),#51a4ff)}
.note{font-size:13px;color:var(--muted);margin-top:12px;text-align:center}
</style>
</head>
<body>
<div class="app" role="application" aria-label="Document Converter">
  <div class="title">Document Converter</div>

  <section class="panel" aria-labelledby="converter-heading">
    <h3 id="converter-heading" class="h">Convert Documents (PDF, DOCX, TXT)</h3>
    <label class="input-file" id="uploadDrop">Click or drop a document here</label>
    <input type="file" id="fileInput" accept=".pdf,.docx,.txt" style="display:none">
    <div>
      <label for="formatSelect">Convert To:</label>
      <select id="formatSelect">
        <option value="pdf">PDF</option>
        <option value="docx">DOCX</option>
        <option value="txt">TXT</option>
      </select>
    </div>
    <div class="progress" id="progress"><i></i></div>
    <button id="convertBtn" disabled>Convert & Download</button>
  </section>
  <div class="note">Note: This converter uses in-browser libraries for TXT and PDF. DOCX conversion is simulated (basic). For production use, consider a server-side API for reliable conversion.</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/2.10.1/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script>
const uploadDrop=document.getElementById('uploadDrop');
const fileInput=document.getElementById('fileInput');
const convertBtn=document.getElementById('convertBtn');
const formatSelect=document.getElementById('formatSelect');
const progress=document.getElementById('progress');
const progFill=progress.querySelector('i');
let currentFile=null;

['dragenter','dragover'].forEach(e=>uploadDrop.addEventListener(e,ev=>{ev.preventDefault();uploadDrop.style.background='#eef6ff'}));
['dragleave','drop'].forEach(e=>uploadDrop.addEventListener(e,ev=>{ev.preventDefault();uploadDrop.style.background=''}));
uploadDrop.addEventListener('drop',e=>{const f=e.dataTransfer.files[0];if(f) loadFile(f)});
uploadDrop.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',e=>{if(e.target.files[0]) loadFile(e.target.files[0])});

function loadFile(file){
  currentFile=file;
  uploadDrop.textContent=`Loaded: ${file.name}`;
  convertBtn.disabled=false;
}

function setProgress(p){progress.style.display=p>=1?'none':'block';progFill.style.width=Math.round(p*100)+'%';}

async function convertAndDownload(){
  if(!currentFile) return alert('Upload a file first');
  const outFormat=formatSelect.value;
  setProgress(0.1);

  try{
    const arr=await currentFile.arrayBuffer();
    let blob;
    const baseName=currentFile.name.replace(/\.[^.]+$/,'');

    if(outFormat==='txt'){
      if(currentFile.type==='application/pdf'){
        // Simplified PDF -> TXT: not extracting text (needs server or OCR), just stub
        blob=new Blob(["[Text extraction from PDF not supported client-side]"],{type:'text/plain'});
      }else{
        blob=new Blob([arr],{type:'text/plain'});
      }
      saveAs(blob, baseName+".txt");
    }
    else if(outFormat==='pdf'){
      if(currentFile.type==='text/plain'){
        const text=await currentFile.text();
        const pdfDoc=await PDFLib.PDFDocument.create();
        const page=pdfDoc.addPage([600,800]);
        page.drawText(text.substring(0,1000),{x:50,y:750,size:12});
        const pdfBytes=await pdfDoc.save();
        blob=new Blob([pdfBytes],{type:'application/pdf'});
      }else{
        blob=new Blob([arr],{type:'application/pdf'});
      }
      saveAs(blob, baseName+".pdf");
    }
    else if(outFormat==='docx'){
      blob=new Blob(["DOCX conversion stub"],{type:'application/vnd.openxmlformats-officedocument.wordprocessingml.document'});
      saveAs(blob, baseName+".docx");
    }
  }catch(err){
    console.error(err);
    alert('Conversion failed: '+err.message);
  }finally{
    setProgress(1);
  }
}

convertBtn.addEventListener('click',convertAndDownload);
</script>
</body>
</html>
